{"version":3,"sources":["../src/player.js"],"names":["App","define","Composite","Fountain","Polygon","Utils","Spawner","Explosion","colors","fuel","particleSize","style","opacity","fromAngle","Math","PI","toAngle","ship","points","Vector","speed","color","randomArray","add","object","explosions","explosionSpawner","length","splice","push","position","size","magnitude","fire","renderer","render","ctx","update","forwardAngle","io","mouse","angle","rotation","config","velocity","copy","scale","scaleTo"],"mappings":"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","file":"player.js","sourcesContent":["App.define(({\r\n    Composite, Fountain,\r\n    Polygon, Utils,\r\n    Spawner, Explosion\r\n}) => class Player extends Composite {\r\n\r\n    constructor(colors) {\r\n        super();\r\n        this.fuel = new Fountain({ particleSize: 6, style: { opacity: 0.25 },\r\n                        fromAngle: Math.PI / 2 * 3 - 0.3, toAngle: Math.PI / 2 * 3 + 0.3 });\r\n        this.ship = new Polygon({ points: [new Vector(-6, 0), new Vector(0, -3), \r\n                                           new Vector(6, 0), new Vector(0, 20)] });\r\n        this.speed = 0;\r\n        this.color = Utils.randomArray(colors);\r\n\r\n        this.add({ object: this.fuel });\r\n        this.add({ object: this.ship });\r\n\r\n        this.explosions = [];\r\n        this.explosionSpawner = new Spawner(() => this.explosions.length > 0,\r\n            () => this.explosions.splice(0, this.explosions.length));\r\n    }\r\n\r\n    kill() {\r\n        this.explosions.push(new Explosion({\r\n            position: this.position, size: 30, particleSize: 20,\r\n            style: { color: this.color }, magnitude: 5\r\n        }).fire());\r\n        this.size = 0;\r\n    }\r\n\r\n    render(renderer) {\r\n        this.explosionSpawner.render(renderer);\r\n        super.render(renderer);\r\n    }\r\n\r\n    update(ctx) {\r\n        super.update(ctx);\r\n        this.explosionSpawner.update(ctx);\r\n\r\n        this.ship.style.color = this.color;\r\n        this.fuel.style.color = this.color;\r\n\r\n        let forwardAngle = io.mouse.angle() + Math.PI;\r\n        this.ship.rotation = forwardAngle + Math.PI / 2;\r\n        this.fuel.config.fromAngle = forwardAngle - 1 / this.speed;\r\n        this.fuel.config.toAngle = forwardAngle + 1 / this.speed;\r\n        this.fuel.config.magnitude = this.speed / 1.5;\r\n        this.fuel.config.size = this.speed / 3;\r\n\r\n        this.velocity.add(io.mouse.copy().scale((1 / 10000) * this.speed));\r\n        if (this.velocity.length() > 4) {\r\n            this.velocity.scaleTo(4);\r\n        }\r\n    }\r\n\r\n});\r\n"]}